!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@sedeh/wizard-storage"),require("@angular/common")):"function"==typeof define&&define.amd?define("@sedeh/tagger",["exports","@angular/core","@sedeh/wizard-storage","@angular/common"],e):e(((t=t||self).sedeh=t.sedeh||{},t.sedeh.tagger={}),t.ng.core,t["wizard-storage"],t.ng.common)}(this,(function(t,e,i,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function g(t,e,i,o){var g,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(g=t[a])&&(s=(r<3?g(s):r>3?g(e,i,s):g(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s}var r=function(){function t(t){this.storage=t}return t.prototype.tagItem=function(t,e){var i=this.getTaggedItems(t);i?(i.push(e),this.storage.session.setItem(t,i)):this.storage.session.setItem(t,[e])},t.prototype.releaseTaggedItem=function(t,e){var i=this.getTaggedItems(t);if(i){var o=this.indexOfTaggedItem(t,e);o>=0&&(i.splice(o,o+1),this.storage.session.setItem(t,i))}else this.storage.session.setItem(t,[])},t.prototype.indexOfTaggedItem=function(t,e){var i=this.getTaggedItems(t),o=-1;i&&i.length&&(i[0].taggedItem?i.map((function(t,i){t.taggedItem==e&&(o=i)})):o=i.indexOf(e));return o},t.prototype.hasTaggedItem=function(t,e){return this.indexOfTaggedItem(t,e)>=0},t.prototype.getTaggedItems=function(t){return this.storage.session.getItem(t)},t.prototype.setTaggedItems=function(t,e){this.storage.session.setItem(t,e)},t.ctorParameters=function(){return[{type:i.WizardStorageService}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(i.WizardStorageService))},token:t,providedIn:"root"}),t=g([e.Injectable({providedIn:"root"})],t)}(),s=function(){function t(t,i){this.renderer=t,this.el=i,this.show=!1,this.tagged=!1,this.change=new e.EventEmitter}return t.prototype.keyup=function(t){13==t.which&&t.target.click()},t.prototype.position=function(t,e,i){this.renderer.setStyle(this.el.nativeElement,"top",t),this.renderer.setStyle(this.el.nativeElement,"left",e),this.renderer.setStyle(this.el.nativeElement,"font-size",i)},t.prototype.showTagger=function(t){t?this.renderer.removeClass(this.el.nativeElement,"hidden"):this.renderer.addClass(this.el.nativeElement,"hidden")},t.ctorParameters=function(){return[{type:e.Renderer2},{type:e.ElementRef}]},g([e.Output()],t.prototype,"change",void 0),t=g([e.Component({selector:"taggerBox",template:'\n    <span \n        class="tagger" \n        tabindex="0" \n        (mouseleave)="$event.target.blur()"\n        (keyup)="keyup($event)"\n        (click)="change.emit($event)">\n        <span class="{{taggedClass}}" aria-hidden="true"></span>\n    <span class="toot-tip" [textContent]="tagged ? taggedIt : tagIt"></span>\n    </span>\n    ',styles:[":host{width:14px;height:14px;position:absolute;color:#fff;z-index:2;cursor:pointer}",":host.hidden{\n            top: -9999px !important;\n            left:-9999px !important;\n        }",":host .toot-tip{\n            display:table;\n            border-radius: 5px;\n            box-shadow:0px 0px 6px #fff;\n            white-space: nowrap;\n            font-size:0.8rem;\n            background-color:#000;\n            color:#fff;\n            padding: 2px 7px;\n            position:absolute;\n            z-index:2;\n            top: 30px;\n            left: -99999px;}",":host .tagger:hover .toot-tip{left: 0}",":host .tagger:focus .toot-tip{left: 0}",":host .tagger:hover{color: red}",":host .tagger:focus{color: red}"]})],t)}(),a=function(){function t(t,i,o,g,r){this.el=t,this.viewRef=i,this.resolver=o,this.taggerService=g,this.renderer=r,this.taggedClass="fa fa-minus-square",this.taggableClass="fa fa-tag",this.taggerSize=24,this.position="top:left",this.dateEnabled=!1,this.sticky=!1,this.tagIt="tag it",this.taggedIt="tagged it",this.taggerChanged=new e.EventEmitter,this.renderer.setStyle(this.el.nativeElement,"display","table"),this.renderer.setStyle(this.el.nativeElement,"position","relative"),this.renderer.setAttribute(this.el.nativeElement,"tabindex","0");var a=this.resolver.resolveComponentFactory(s),n=this.viewRef.createComponent(a),h=n.hostView.rootNodes[0];this.el.nativeElement.appendChild(h),this.taggerBox=n.instance,this.taggerBox.change.subscribe(this.onTagSelect.bind(this))}return t.prototype.focus=function(t){this.taggerBox.showTagger(!0)},t.prototype.enter=function(t){this.taggerBox.tagged=this.taggerService.hasTaggedItem(this.tagger,this.taggerBox.id),this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerBox.showTagger(!0)},t.prototype.hoverOut=function(t){if(!this.sticky&&!t.target.showTagger){var e=this.el.nativeElement.getBoundingClientRect();(t.x<e.x||t.clientX>=e.x+e.width||t.y<e.y||t.clientY>=e.y+e.height)&&this.taggerBox.showTagger(!1)}},t.prototype.ngOnInit=function(){var t=this.position.split(":"),e=this.taggerSize+2+"px",i="top"===t[0]?"5px":"bottom"===t[0]?"calc(100% - "+e+")":"calc((100% - "+e+")/2)",o="left"===t[1]?"5px":"right"===t[1]?"calc(100% - "+e+")":"calc((100% - "+e+")/2)";this.taggerBox.position(i,o,this.taggerSize+"px"),this.taggerBox.id="object"==typeof this.taggerTag?JSON.stringify(this.taggerTag):this.taggerTag,this.taggerBox.tagged=this.taggerService.hasTaggedItem(this.tagger,this.taggerBox.id),this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerBox.tagIt=this.tagIt,this.taggerBox.taggedIt=this.taggedIt,this.taggerBox.showTagger(this.sticky)},t.prototype.onTagSelect=function(t){if(this.taggerBox.tagged=!this.taggerBox.tagged,this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerBox.tagged)if(this.dateEnabled){var e={taggedItem:this.taggerBox.id,tagDate:new Date};this.taggerService.tagItem(this.tagger,e)}else this.taggerService.tagItem(this.tagger,this.taggerBox.id);else this.taggerService.releaseTaggedItem(this.tagger,this.taggerBox.id);this.dateEnabled?this.taggerChanged.emit({tagger:this.tagger,taggedItem:this.taggerBox.id,tagDate:new Date}):this.taggerChanged.emit(this.tagger)},t.ctorParameters=function(){return[{type:e.ElementRef},{type:e.ViewContainerRef},{type:e.ComponentFactoryResolver},{type:r},{type:e.Renderer2}]},g([e.Input()],t.prototype,"taggedClass",void 0),g([e.Input()],t.prototype,"taggableClass",void 0),g([e.Input()],t.prototype,"tagger",void 0),g([e.Input()],t.prototype,"taggerSize",void 0),g([e.Input()],t.prototype,"position",void 0),g([e.Input()],t.prototype,"taggerTag",void 0),g([e.Input()],t.prototype,"dateEnabled",void 0),g([e.Input()],t.prototype,"sticky",void 0),g([e.Input()],t.prototype,"tagIt",void 0),g([e.Input()],t.prototype,"taggedIt",void 0),g([e.Output("taggerChanged")],t.prototype,"taggerChanged",void 0),g([e.HostListener("focus",["$event"])],t.prototype,"focus",null),g([e.HostListener("mouseenter",["$event"])],t.prototype,"enter",null),g([e.HostListener("mouseout",["$event"])],t.prototype,"hoverOut",null),t=g([e.Directive({selector:"[tagger]"})],t)}(),n=function(){function t(){}return t=g([e.NgModule({imports:[o.CommonModule,i.WizardStorageModule],declarations:[s,a],exports:[a],entryComponents:[s],providers:[r],schemas:[e.CUSTOM_ELEMENTS_SCHEMA]})],t)}();t.TaggerDirective=a,t.TaggerModule=n,t.TaggerService=r,t.ɵa=s,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=sedeh-tagger.umd.min.js.map