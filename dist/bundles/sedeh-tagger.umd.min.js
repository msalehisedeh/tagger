!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@sedeh/wizard-storage"),require("@angular/common")):"function"==typeof define&&define.amd?define("@sedeh/tagger",["exports","@angular/core","@sedeh/wizard-storage","@angular/common"],t):t((e.sedeh=e.sedeh||{},e.sedeh.tagger={}),e.ng.core,e["wizard-storage"],e.ng.common)}(this,function(e,n,t,s){"use strict";var r=function(){function e(e){this.storage=e}return e.prototype.updateTag=function(e,t,s){var r=this.getTaggedItems(e);if(r)if(t)r.push(s),this.storage.session.setItem(e,r);else{var i=this.indexOfTaggedItem(e,s);0<=i&&(r.splice(i,i+1),this.storage.session.setItem(e,r))}else this.storage.session.setItem(e,t?[s]:[])},e.prototype.indexOfTaggedItem=function(e,t){var s=this.getTaggedItems(e),r=-1;return s&&(r=s.indexOf(t)),r},e.prototype.hasTaggedItem=function(e,t){return 0<=this.indexOfTaggedItem(e,t)},e.prototype.getTaggedItems=function(e){return this.storage.session.getItem(e)},e.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:t.WizardStorageService}]},e.ngInjectableDef=n.defineInjectable({factory:function(){return new e(n.inject(t.WizardStorageService))},token:e,providedIn:"root"}),e}(),h=function(){function e(e,t){this.renderer=e,this.el=t,this.show=!1,this.tagged=!1,this.change=new n.EventEmitter}return e.prototype.keyup=function(e){13==e.which&&e.target.click()},e.prototype.position=function(e,t,s){this.renderer.setStyle(this.el.nativeElement,"top",e),this.renderer.setStyle(this.el.nativeElement,"left",t),this.renderer.setStyle(this.el.nativeElement,"font-size",s)},e.prototype.showTagger=function(e){e?this.renderer.removeClass(this.el.nativeElement,"hidden"):this.renderer.addClass(this.el.nativeElement,"hidden")},e.decorators=[{type:n.Component,args:[{selector:"taggerBox",template:'\n    <span \n        class="tagger {{taggedClass}}" \n        tabindex="0" \n        aria-hidden=\'true\'\n        (keyup)="keyup($event)"\n        (click)="change.emit($event)"></span>\n    <span style="display:block;position:absolute;left:-9999px;top:-9999px;width:1px;height:1px">\n    {{tagged ? \'tag this item\' : \'remove tag of this item\'}}\n    </span>\n    ',styles:[":host{width: 14px;height: 14px;position: absolute;color: #fff;z-index: 2;}",":host.hidden{top: -9999px !important;left:-9999px !important;}",":host .tagger:hover{color: red}",":host .tagger:focus{color: red}"]}]}],e.ctorParameters=function(){return[{type:n.Renderer2},{type:n.ElementRef}]},e.propDecorators={change:[{type:n.Output}]},e}(),i=function(){function e(e,t,s,r,i){this.el=e,this.viewRef=t,this.resolver=s,this.taggerService=r,this.renderer=i,this.taggedClass="fa fa-minus-square",this.taggableClass="fa fa-tag",this.taggerSize=24,this.position="top:left",this.sticky=!1,this.taggerChanged=new n.EventEmitter,this.renderer.setStyle(this.el.nativeElement,"display","table"),this.renderer.setStyle(this.el.nativeElement,"position","relative"),this.renderer.setAttribute(this.el.nativeElement,"tabindex","0");var a=this.resolver.resolveComponentFactory(h),g=this.viewRef.createComponent(a),o=g.hostView.rootNodes[0];this.el.nativeElement.appendChild(o),this.taggerBox=g.instance,this.taggerBox.change.subscribe(this.onTagSelect.bind(this))}return e.prototype.focus=function(e){this.taggerBox.showTagger(!0)},e.prototype.enter=function(e){this.taggerBox.tagged=this.taggerService.hasTaggedItem(this.tagger,this.taggerTag),this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerBox.showTagger(!0)},e.prototype.hoverOut=function(e){if(!this.sticky&&!e.target.showTagger){var t=this.el.nativeElement.getBoundingClientRect();(e.x<t.x||e.clientX>=t.x+t.width||e.y<t.y||e.clientY>=t.y+t.height)&&this.taggerBox.showTagger(!1)}},e.prototype.ngOnInit=function(){var e=this.position.split(":"),t=this.taggerSize+2+"px",s="top"===e[0]?"5px":"bottom"===e[0]?"calc(100% - "+t+")":"calc((100% - "+t+")/2)",r="left"===e[1]?"5px":"right"===e[1]?"calc(100% - "+t+")":"calc((100% - "+t+")/2)";this.taggerBox.position(s,r,this.taggerSize+"px"),this.taggerBox.tagged=this.taggerService.hasTaggedItem(this.tagger,this.taggerTag),this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerBox.showTagger(this.sticky)},e.prototype.onTagSelect=function(e){this.taggerBox.tagged=!this.taggerBox.tagged,this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerService.updateTag(this.tagger,this.taggerBox.tagged,this.taggerTag),this.taggerChanged.emit(this.tagger)},e.decorators=[{type:n.Directive,args:[{selector:"[tagger]"}]}],e.ctorParameters=function(){return[{type:n.ElementRef},{type:n.ViewContainerRef},{type:n.ComponentFactoryResolver},{type:r},{type:n.Renderer2}]},e.propDecorators={taggedClass:[{type:n.Input}],taggableClass:[{type:n.Input}],tagger:[{type:n.Input}],taggerSize:[{type:n.Input}],position:[{type:n.Input}],taggerTag:[{type:n.Input}],sticky:[{type:n.Input}],taggerChanged:[{type:n.Output,args:["taggerChanged"]}],focus:[{type:n.HostListener,args:["focus",["$event"]]}],enter:[{type:n.HostListener,args:["mouseenter",["$event"]]}],hoverOut:[{type:n.HostListener,args:["mouseout",["$event"]]}]},e}(),a=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[s.CommonModule,t.WizardStorageModule],declarations:[h,i],exports:[i],entryComponents:[h],providers:[r],schemas:[n.CUSTOM_ELEMENTS_SCHEMA]}]}],e}();e.taggerDirective=i,e.TaggerService=r,e.TaggerModule=a,e.Éµa=h,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sedeh-tagger.umd.min.js.map