!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@sedeh/wizard-storage"),require("@angular/common")):"function"==typeof define&&define.amd?define("@sedeh/tagger",["exports","@angular/core","@sedeh/wizard-storage","@angular/common"],e):e((t.sedeh=t.sedeh||{},t.sedeh.tagger={}),t.ng.core,t["wizard-storage"],t.ng.common)}(this,function(t,n,e,s){"use strict";var g=function(){function t(t){this.storage=t}return t.prototype.tagItem=function(t,e){var s=this.getTaggedItems(t);s?(s.push(e),this.storage.session.setItem(t,s)):this.storage.session.setItem(t,[e])},t.prototype.releaseTaggedItem=function(t,e){var s=this.getTaggedItems(t);if(s){var g=this.indexOfTaggedItem(t,e);0<=g&&(s.splice(g,g+1),this.storage.session.setItem(t,s))}else this.storage.session.setItem(t,[])},t.prototype.indexOfTaggedItem=function(t,s){var e=this.getTaggedItems(t),g=-1;e&&e.length&&(e[0].taggedItem?e.map(function(t,e){t.taggedItem==s&&(g=e)}):g=e.indexOf(s));return g},t.prototype.hasTaggedItem=function(t,e){return 0<=this.indexOfTaggedItem(t,e)},t.prototype.getTaggedItems=function(t){return this.storage.session.getItem(t)},t.prototype.setTaggedItems=function(t,e){this.storage.session.setItem(t,e)},t.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:e.WizardStorageService}]},t.ngInjectableDef=n.defineInjectable({factory:function(){return new t(n.inject(e.WizardStorageService))},token:t,providedIn:"root"}),t}(),h=function(){function t(t,e){this.renderer=t,this.el=e,this.show=!1,this.tagged=!1,this.change=new n.EventEmitter}return t.prototype.keyup=function(t){13==t.which&&t.target.click()},t.prototype.position=function(t,e,s){this.renderer.setStyle(this.el.nativeElement,"top",t),this.renderer.setStyle(this.el.nativeElement,"left",e),this.renderer.setStyle(this.el.nativeElement,"font-size",s)},t.prototype.showTagger=function(t){t?this.renderer.removeClass(this.el.nativeElement,"hidden"):this.renderer.addClass(this.el.nativeElement,"hidden")},t.decorators=[{type:n.Component,args:[{selector:"taggerBox",template:'\n    <span \n        class="tagger" \n        tabindex="0" \n        (mouseleave)="$event.target.blur()"\n        (keyup)="keyup($event)"\n        (click)="change.emit($event)">\n        <span class="{{taggedClass}}" aria-hidden="true"></span>\n    <span class="toot-tip" [textContent]="tagged ? taggedIt : tagIt"></span>\n    </span>\n    ',styles:[":host{width:14px;height:14px;position:absolute;color:#fff;z-index:2;cursor:pointer}",":host.hidden{\n            top: -9999px !important;\n            left:-9999px !important;\n        }",":host .toot-tip{\n            display:table;\n            border-radius: 5px;\n            box-shadow:0px 0px 6px #fff;\n            white-space: nowrap;\n            font-size:0.8rem;\n            background-color:#000;\n            color:#fff;\n            padding: 2px 7px;\n            position:absolute;\n            z-index:2;\n            top: 30px;\n            left: -99999px;}",":host .tagger:hover .toot-tip{left: 0}",":host .tagger:focus .toot-tip{left: 0}",":host .tagger:hover{color: red}",":host .tagger:focus{color: red}"]}]}],t.ctorParameters=function(){return[{type:n.Renderer2},{type:n.ElementRef}]},t.propDecorators={change:[{type:n.Output}]},t}(),a=function(){function t(t,e,s,g,a){this.el=t,this.viewRef=e,this.resolver=s,this.taggerService=g,this.renderer=a,this.taggedClass="fa fa-minus-square",this.taggableClass="fa fa-tag",this.taggerSize=24,this.position="top:left",this.dateEnabled=!1,this.sticky=!1,this.tagIt="tag it",this.taggedIt="tagged it",this.taggerChanged=new n.EventEmitter,this.renderer.setStyle(this.el.nativeElement,"display","table"),this.renderer.setStyle(this.el.nativeElement,"position","relative"),this.renderer.setAttribute(this.el.nativeElement,"tabindex","0");var r=this.resolver.resolveComponentFactory(h),i=this.viewRef.createComponent(r),o=i.hostView.rootNodes[0];this.el.nativeElement.appendChild(o),this.taggerBox=i.instance,this.taggerBox.change.subscribe(this.onTagSelect.bind(this))}return t.prototype.focus=function(t){this.taggerBox.showTagger(!0)},t.prototype.enter=function(t){this.taggerBox.tagged=this.taggerService.hasTaggedItem(this.tagger,this.taggerBox.id),this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerBox.showTagger(!0)},t.prototype.hoverOut=function(t){if(!this.sticky&&!t.target.showTagger){var e=this.el.nativeElement.getBoundingClientRect();(t.x<e.x||t.clientX>=e.x+e.width||t.y<e.y||t.clientY>=e.y+e.height)&&this.taggerBox.showTagger(!1)}},t.prototype.ngOnInit=function(){var t=this.position.split(":"),e=this.taggerSize+2+"px",s="top"===t[0]?"5px":"bottom"===t[0]?"calc(100% - "+e+")":"calc((100% - "+e+")/2)",g="left"===t[1]?"5px":"right"===t[1]?"calc(100% - "+e+")":"calc((100% - "+e+")/2)";this.taggerBox.position(s,g,this.taggerSize+"px"),this.taggerBox.id="object"==typeof this.taggerTag?JSON.stringify(this.taggerTag):this.taggerTag,this.taggerBox.tagged=this.taggerService.hasTaggedItem(this.tagger,this.taggerBox.id),this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerBox.tagIt=this.tagIt,this.taggerBox.taggedIt=this.taggedIt,this.taggerBox.showTagger(this.sticky)},t.prototype.onTagSelect=function(t){if(this.taggerBox.tagged=!this.taggerBox.tagged,this.taggerBox.taggedClass=this.taggerBox.tagged?this.taggedClass:this.taggableClass,this.taggerBox.tagged)if(this.dateEnabled){var e={taggedItem:this.taggerBox.id,tagDate:new Date};this.taggerService.tagItem(this.tagger,e)}else this.taggerService.tagItem(this.tagger,this.taggerBox.id);else this.taggerService.releaseTaggedItem(this.tagger,this.taggerBox.id);this.dateEnabled?this.taggerChanged.emit({tagger:this.tagger,taggedItem:this.taggerBox.id,tagDate:new Date}):this.taggerChanged.emit(this.tagger)},t.decorators=[{type:n.Directive,args:[{selector:"[tagger]"}]}],t.ctorParameters=function(){return[{type:n.ElementRef},{type:n.ViewContainerRef},{type:n.ComponentFactoryResolver},{type:g},{type:n.Renderer2}]},t.propDecorators={taggedClass:[{type:n.Input}],taggableClass:[{type:n.Input}],tagger:[{type:n.Input}],taggerSize:[{type:n.Input}],position:[{type:n.Input}],taggerTag:[{type:n.Input}],dateEnabled:[{type:n.Input}],sticky:[{type:n.Input}],tagIt:[{type:n.Input}],taggedIt:[{type:n.Input}],taggerChanged:[{type:n.Output,args:["taggerChanged"]}],focus:[{type:n.HostListener,args:["focus",["$event"]]}],enter:[{type:n.HostListener,args:["mouseenter",["$event"]]}],hoverOut:[{type:n.HostListener,args:["mouseout",["$event"]]}]},t}(),r=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[s.CommonModule,e.WizardStorageModule],declarations:[h,a],exports:[a],entryComponents:[h],providers:[g],schemas:[n.CUSTOM_ELEMENTS_SCHEMA]}]}],t}();t.TaggerDirective=a,t.TaggerService=g,t.TaggerModule=r,t.Éµa=h,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=sedeh-tagger.umd.min.js.map